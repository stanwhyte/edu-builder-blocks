AWSTemplateFormatVersion: '2010-09-09'
Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: CloudFormation Bucket Information
        Parameters:
          - BucketRegion
          - BucketName
          - KeyPrefix
          - BucketPartition
          - BucketUrlSuffix
    ParameterLabels:
      BucketUrlSuffix:
        default: S3 Bucket URL Suffix
      BucketPartition:
        default: S3 Bucket Partition
      BucketName:
        default: S3 Bucket Name
      BucketRegion:
        default: S3 Bucket Region
      KeyPrefix:
        default: S3 Key Prefix
Parameters:
  BucketUrlSuffix:
    Type: String
    Default: amazonaws.com
    AllowedValues:
      - amazonaws.com
      - amazonaws.com.cn
  BucketPartition:
    Type: String
    Default: aws
    AllowedValues:
      - aws
      - aws-cn
      - aws-us-gov
  BucketName:
    Description: SSM Parameter with the S3 bucket name containing the
      CloudFormation assets.
    Type: AWS::SSM::Parameter::Value<String>
    Default: /Bootstrap/CloudFormation/S3/Bucket/Name
  BucketRegion:
    Description: SSM Parameter with the region for the S3 bucket containing the
      CloudFormation assets.
    Type: AWS::SSM::Parameter::Value<String>
    Default: /Bootstrap/CloudFormation/S3/Bucket/Region
  KeyPrefix:
    Description: S3 key prefix for the CloudFormation assets. Key prefix
      can include numbers, lowercase letters, uppercase letters, hyphens (-), 
      and forward slash (/).
    Type: AWS::SSM::Parameter::Value<String>
    Default: /Bootstrap/CloudFormation/S3/Bucket/KeyPrefix
Mappings:
  Keys:
    Bootstrap:
      BucketUrl: /Bootstrap/CloudFormation/S3/Bucket/Url
      BucketArn: /Bootstrap/CloudFormation/S3/Bucket/Arn 
      BucketFullArn: /Bootstrap/CloudFormation/S3/Bucket/FullArn 
Resources:
  ParamBucketUrl:
    Type: AWS::SSM::Parameter
    Properties:
      Description: The full URL for the CloudFormation templates
      Name: !FindInMap [Keys,Bootstrap,BucketUrl]
      Value: !Sub 'https://${BucketName}.s3.${BucketRegion}.${BucketUrlSuffix}/${KeyPrefix}'
      Type: String
  ParamBucketFullArn:
    Type: AWS::SSM::Parameter
    Properties:
      Description: The full arn for the CloudFormation templates (with folder)
      Name: !FindInMap [Keys,Bootstrap,BucketFullArn]
      Value: !Sub 'arn:${BucketPartition}:s3:::${BucketName}/${KeyPrefix}'
      Type: String
  ParamBucketArn:
    Type: AWS::SSM::Parameter
    Properties:
      Description: The arn for the CloudFormation templates (without the folder)
      Name: !FindInMap [Keys,Bootstrap,BucketArn]
      Value: !Sub 'arn:${BucketPartition}:s3:::${BucketName}/'
      Type: String
